(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();function Ne(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var be={exports:{}};var He=be.exports,Ae;function Ke(){return Ae||(Ae=1,(function(e,r){((i,s)=>{e.exports=s()})(He,function i(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},o,l=!s.document&&!!s.postMessage,d=s.IS_PAPA_WORKER||!1,_={},c=0,u={};function g(n){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var a=ce(t);a.chunkSize=parseInt(a.chunkSize),t.step||t.chunk||(a.chunkSize=null),this._handle=new P(a),(this._handle.streamer=this)._config=a}).call(this,n),this.parseChunk=function(t,a){var h=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<h){let y=this._config.newline;y||(f=this._config.quoteChar||'"',y=this._handle.guessLineEndings(t,f)),t=[...t.split(y).slice(h)].join(y)}this.isFirstChunk&&R(this._config.beforeFirstChunk)&&(f=this._config.beforeFirstChunk(t))!==void 0&&(t=f),this.isFirstChunk=!1,this._halted=!1;var h=this._partialLine+t,f=(this._partialLine="",this._handle.parse(h,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=f.meta.cursor,h=(this._finished||(this._partialLine=h.substring(t-this._baseIndex),this._baseIndex=t),f&&f.data&&(this._rowCount+=f.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),d)s.postMessage({results:f,workerId:u.WORKER_ID,finished:h});else if(R(this._config.chunk)&&!a){if(this._config.chunk(f,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=f=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(f.data),this._completeResults.errors=this._completeResults.errors.concat(f.errors),this._completeResults.meta=f.meta),this._completed||!h||!R(this._config.complete)||f&&f.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),h||f&&f.meta.paused||this._nextChunk(),f}this._halted=!0},this._sendError=function(t){R(this._config.error)?this._config.error(t):d&&this._config.error&&s.postMessage({workerId:u.WORKER_ID,error:t,finished:!1})}}function O(n){var t;(n=n||{}).chunkSize||(n.chunkSize=u.RemoteChunkSize),g.call(this,n),this._nextChunk=l?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(a){this._input=a,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),l||(t.onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!l),this._config.downloadRequestHeaders){var a,h=this._config.downloadRequestHeaders;for(a in h)t.setRequestHeader(a,h[a])}var f;this._config.chunkSize&&(f=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+f));try{t.send(this._config.downloadRequestBody)}catch(y){this._chunkError(y.message)}l&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(a=>(a=a.getResponseHeader("Content-Range"))!==null?parseInt(a.substring(a.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(a){a=t.statusText||a,this._sendError(new Error(a))}}function U(n){(n=n||{}).chunkSize||(n.chunkSize=u.LocalChunkSize),g.call(this,n);var t,a,h=typeof FileReader<"u";this.stream=function(f){this._input=f,a=f.slice||f.webkitSlice||f.mozSlice,h?((t=new FileReader).onload=se(this._chunkLoaded,this),t.onerror=se(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var f=this._input,y=(this._config.chunkSize&&(y=Math.min(this._start+this._config.chunkSize,this._input.size),f=a.call(f,this._start,y)),t.readAsText(f,this._config.encoding));h||this._chunkLoaded({target:{result:y}})},this._chunkLoaded=function(f){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(f.target.result)},this._chunkError=function(){this._sendError(t.error)}}function N(n){var t;g.call(this,n=n||{}),this.stream=function(a){return t=a,this._nextChunk()},this._nextChunk=function(){var a,h;if(!this._finished)return a=this._config.chunkSize,t=a?(h=t.substring(0,a),t.substring(a)):(h=t,""),this._finished=!t,this.parseChunk(h)}}function G(n){g.call(this,n=n||{});var t=[],a=!0,h=!1;this.pause=function(){g.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){g.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(f){this._input=f,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){h&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):a=!0},this._streamData=se(function(f){try{t.push(typeof f=="string"?f:f.toString(this._config.encoding)),a&&(a=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(y){this._streamError(y)}},this),this._streamError=se(function(f){this._streamCleanUp(),this._sendError(f)},this),this._streamEnd=se(function(){this._streamCleanUp(),h=!0,this._streamData("")},this),this._streamCleanUp=se(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function P(n){var t,a,h,f,y=Math.pow(2,53),M=-y,V=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,te=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,E=this,j=0,m=0,Y=!1,v=!1,w=[],p={data:[],errors:[],meta:{}};function W(C){return n.skipEmptyLines==="greedy"?C.join("").trim()==="":C.length===1&&C[0].length===0}function z(){if(p&&h&&(ne("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),h=!1),n.skipEmptyLines&&(p.data=p.data.filter(function(A){return!W(A)})),J()){let A=function(K,B){R(n.transformHeader)&&(K=n.transformHeader(K,B)),w.push(K)};var b=A;if(p)if(Array.isArray(p.data[0])){for(var C=0;J()&&C<p.data.length;C++)p.data[C].forEach(A);p.data.splice(0,1)}else p.data.forEach(A)}function S(A,K){for(var B=n.header?{}:[],I=0;I<A.length;I++){var k=I,Z=A[I],Z=((x,F)=>(q=>(n.dynamicTypingFunction&&n.dynamicTyping[q]===void 0&&(n.dynamicTyping[q]=n.dynamicTypingFunction(q)),(n.dynamicTyping[q]||n.dynamicTyping)===!0))(x)?F==="true"||F==="TRUE"||F!=="false"&&F!=="FALSE"&&((q=>{if(V.test(q)&&(q=parseFloat(q),M<q&&q<y))return 1})(F)?parseFloat(F):te.test(F)?new Date(F):F===""?null:F):F)(k=n.header?I>=w.length?"__parsed_extra":w[I]:k,Z=n.transform?n.transform(Z,k):Z);k==="__parsed_extra"?(B[k]=B[k]||[],B[k].push(Z)):B[k]=Z}return n.header&&(I>w.length?ne("FieldMismatch","TooManyFields","Too many fields: expected "+w.length+" fields but parsed "+I,m+K):I<w.length&&ne("FieldMismatch","TooFewFields","Too few fields: expected "+w.length+" fields but parsed "+I,m+K)),B}var $;p&&(n.header||n.dynamicTyping||n.transform)&&($=1,!p.data.length||Array.isArray(p.data[0])?(p.data=p.data.map(S),$=p.data.length):p.data=S(p.data,0),n.header&&p.meta&&(p.meta.fields=w),m+=$)}function J(){return n.header&&w.length===0}function ne(C,S,$,b){C={type:C,code:S,message:$},b!==void 0&&(C.row=b),p.errors.push(C)}R(n.step)&&(f=n.step,n.step=function(C){p=C,J()?z():(z(),p.data.length!==0&&(j+=C.data.length,n.preview&&j>n.preview?a.abort():(p.data=p.data[0],f(p,E))))}),this.parse=function(C,S,$){var b=n.quoteChar||'"',b=(n.newline||(n.newline=this.guessLineEndings(C,b)),h=!1,n.delimiter?R(n.delimiter)&&(n.delimiter=n.delimiter(C),p.meta.delimiter=n.delimiter):((b=((A,K,B,I,k)=>{var Z,x,F,q;k=k||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var de=0;de<k.length;de++){for(var ie,_e=k[de],X=0,oe=0,Q=0,ee=(F=void 0,new T({comments:I,delimiter:_e,newline:K,preview:10}).parse(A)),le=0;le<ee.data.length;le++)B&&W(ee.data[le])?Q++:(ie=ee.data[le].length,oe+=ie,F===void 0?F=ie:0<ie&&(X+=Math.abs(ie-F),F=ie));0<ee.data.length&&(oe/=ee.data.length-Q),(x===void 0||X<=x)&&(q===void 0||q<oe)&&1.99<oe&&(x=X,Z=_e,q=oe)}return{successful:!!(n.delimiter=Z),bestDelimiter:Z}})(C,n.newline,n.skipEmptyLines,n.comments,n.delimitersToGuess)).successful?n.delimiter=b.bestDelimiter:(h=!0,n.delimiter=u.DefaultDelimiter),p.meta.delimiter=n.delimiter),ce(n));return n.preview&&n.header&&b.preview++,t=C,a=new T(b),p=a.parse(t,S,$),z(),Y?{meta:{paused:!0}}:p||{meta:{paused:!1}}},this.paused=function(){return Y},this.pause=function(){Y=!0,a.abort(),t=R(n.chunk)?"":t.substring(a.getCharIndex())},this.resume=function(){E.streamer._halted?(Y=!1,E.streamer.parseChunk(t,!0)):setTimeout(E.resume,3)},this.aborted=function(){return v},this.abort=function(){v=!0,a.abort(),p.meta.aborted=!0,R(n.complete)&&n.complete(p),t=""},this.guessLineEndings=function(A,b){A=A.substring(0,1048576);var b=new RegExp(L(b)+"([^]*?)"+L(b),"gm"),$=(A=A.replace(b,"")).split("\r"),b=A.split(`
`),A=1<b.length&&b[0].length<$[0].length;if($.length===1||A)return`
`;for(var K=0,B=0;B<$.length;B++)$[B][0]===`
`&&K++;return K>=$.length/2?`\r
`:"\r"}}function L(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function T(n){var t=(n=n||{}).delimiter,a=n.newline,h=n.comments,f=n.step,y=n.preview,M=n.fastMode,V=null,te=!1,E=n.quoteChar==null?'"':n.quoteChar,j=E;if(n.escapeChar!==void 0&&(j=n.escapeChar),(typeof t!="string"||-1<u.BAD_DELIMITERS.indexOf(t))&&(t=","),h===t)throw new Error("Comment character same as delimiter");h===!0?h="#":(typeof h!="string"||-1<u.BAD_DELIMITERS.indexOf(h))&&(h=!1),a!==`
`&&a!=="\r"&&a!==`\r
`&&(a=`
`);var m=0,Y=!1;this.parse=function(v,w,p){if(typeof v!="string")throw new Error("Input must be a string");var W=v.length,z=t.length,J=a.length,ne=h.length,C=R(f),S=[],$=[],b=[],A=m=0;if(!v)return X();if(M||M!==!1&&v.indexOf(E)===-1){for(var K=v.split(a),B=0;B<K.length;B++){if(b=K[B],m+=b.length,B!==K.length-1)m+=a.length;else if(p)return X();if(!h||b.substring(0,ne)!==h){if(C){if(S=[],q(b.split(t)),oe(),Y)return X()}else q(b.split(t));if(y&&y<=B)return S=S.slice(0,y),X(!0)}}return X()}for(var I=v.indexOf(t,m),k=v.indexOf(a,m),Z=new RegExp(L(j)+L(E),"g"),x=v.indexOf(E,m);;)if(v[m]===E)for(x=m,m++;;){if((x=v.indexOf(E,x+1))===-1)return p||$.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:S.length,index:m}),ie();if(x===W-1)return ie(v.substring(m,x).replace(Z,E));if(E===j&&v[x+1]===j)x++;else if(E===j||x===0||v[x-1]!==j){I!==-1&&I<x+1&&(I=v.indexOf(t,x+1));var F=de((k=k!==-1&&k<x+1?v.indexOf(a,x+1):k)===-1?I:Math.min(I,k));if(v.substr(x+1+F,z)===t){b.push(v.substring(m,x).replace(Z,E)),v[m=x+1+F+z]!==E&&(x=v.indexOf(E,m)),I=v.indexOf(t,m),k=v.indexOf(a,m);break}if(F=de(k),v.substring(x+1+F,x+1+F+J)===a){if(b.push(v.substring(m,x).replace(Z,E)),_e(x+1+F+J),I=v.indexOf(t,m),x=v.indexOf(E,m),C&&(oe(),Y))return X();if(y&&S.length>=y)return X(!0);break}$.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:S.length,index:m}),x++}}else if(h&&b.length===0&&v.substring(m,m+ne)===h){if(k===-1)return X();m=k+J,k=v.indexOf(a,m),I=v.indexOf(t,m)}else if(I!==-1&&(I<k||k===-1))b.push(v.substring(m,I)),m=I+z,I=v.indexOf(t,m);else{if(k===-1)break;if(b.push(v.substring(m,k)),_e(k+J),C&&(oe(),Y))return X();if(y&&S.length>=y)return X(!0)}return ie();function q(Q){S.push(Q),A=m}function de(Q){var ee=0;return ee=Q!==-1&&(Q=v.substring(x+1,Q))&&Q.trim()===""?Q.length:ee}function ie(Q){return p||(Q===void 0&&(Q=v.substring(m)),b.push(Q),m=W,q(b),C&&oe()),X()}function _e(Q){m=Q,q(b),b=[],k=v.indexOf(a,m)}function X(Q){if(n.header&&!w&&S.length&&!te){var ee=S[0],le=Object.create(null),Ce=new Set(ee);let Le=!1;for(let fe=0;fe<ee.length;fe++){let ae=ee[fe];if(le[ae=R(n.transformHeader)?n.transformHeader(ae,fe):ae]){let ge,Te=le[ae];for(;ge=ae+"_"+Te,Te++,Ce.has(ge););Ce.add(ge),ee[fe]=ge,le[ae]++,Le=!0,(V=V===null?{}:V)[ge]=ae}else le[ae]=1,ee[fe]=ae;Ce.add(ae)}Le&&console.warn("Duplicate headers found and renamed."),te=!0}return{data:S,errors:$,meta:{delimiter:t,linebreak:a,aborted:Y,truncated:!!Q,cursor:A+(w||0),renamedHeaders:V}}}function oe(){f(X()),S=[],$=[]}},this.abort=function(){Y=!0},this.getCharIndex=function(){return m}}function H(n){var t=n.data,a=_[t.workerId],h=!1;if(t.error)a.userError(t.error,t.file);else if(t.results&&t.results.data){var f={abort:function(){h=!0,ue(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:re,resume:re};if(R(a.userStep)){for(var y=0;y<t.results.data.length&&(a.userStep({data:t.results.data[y],errors:t.results.errors,meta:t.results.meta},f),!h);y++);delete t.results}else R(a.userChunk)&&(a.userChunk(t.results,f,t.file),delete t.results)}t.finished&&!h&&ue(t.workerId,t.results)}function ue(n,t){var a=_[n];R(a.userComplete)&&a.userComplete(t),a.terminate(),delete _[n]}function re(){throw new Error("Not implemented.")}function ce(n){if(typeof n!="object"||n===null)return n;var t,a=Array.isArray(n)?[]:{};for(t in n)a[t]=ce(n[t]);return a}function se(n,t){return function(){n.apply(t,arguments)}}function R(n){return typeof n=="function"}return u.parse=function(n,t){var a=(t=t||{}).dynamicTyping||!1;if(R(a)&&(t.dynamicTypingFunction=a,a={}),t.dynamicTyping=a,t.transform=!!R(t.transform)&&t.transform,!t.worker||!u.WORKERS_SUPPORTED)return a=null,u.NODE_STREAM_INPUT,typeof n=="string"?(n=(h=>h.charCodeAt(0)!==65279?h:h.slice(1))(n),a=new(t.download?O:N)(t)):n.readable===!0&&R(n.read)&&R(n.on)?a=new G(t):(s.File&&n instanceof File||n instanceof Object)&&(a=new U(t)),a.stream(n);(a=(()=>{var h;return!!u.WORKERS_SUPPORTED&&(h=(()=>{var f=s.URL||s.webkitURL||null,y=i.toString();return u.BLOB_URL||(u.BLOB_URL=f.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",y,")();"],{type:"text/javascript"})))})(),(h=new s.Worker(h)).onmessage=H,h.id=c++,_[h.id]=h)})()).userStep=t.step,a.userChunk=t.chunk,a.userComplete=t.complete,a.userError=t.error,t.step=R(t.step),t.chunk=R(t.chunk),t.complete=R(t.complete),t.error=R(t.error),delete t.worker,a.postMessage({input:n,config:t,workerId:a.id})},u.unparse=function(n,t){var a=!1,h=!0,f=",",y=`\r
`,M='"',V=M+M,te=!1,E=null,j=!1,m=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||u.BAD_DELIMITERS.filter(function(w){return t.delimiter.indexOf(w)!==-1}).length||(f=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(a=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(te=t.skipEmptyLines),typeof t.newline=="string"&&(y=t.newline),typeof t.quoteChar=="string"&&(M=t.quoteChar),typeof t.header=="boolean"&&(h=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");E=t.columns}t.escapeChar!==void 0&&(V=t.escapeChar+M),t.escapeFormulae instanceof RegExp?j=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(j=/^[=+\-@\t\r].*$/)}})(),new RegExp(L(M),"g"));if(typeof n=="string"&&(n=JSON.parse(n)),Array.isArray(n)){if(!n.length||Array.isArray(n[0]))return Y(null,n,te);if(typeof n[0]=="object")return Y(E||Object.keys(n[0]),n,te)}else if(typeof n=="object")return typeof n.data=="string"&&(n.data=JSON.parse(n.data)),Array.isArray(n.data)&&(n.fields||(n.fields=n.meta&&n.meta.fields||E),n.fields||(n.fields=Array.isArray(n.data[0])?n.fields:typeof n.data[0]=="object"?Object.keys(n.data[0]):[]),Array.isArray(n.data[0])||typeof n.data[0]=="object"||(n.data=[n.data])),Y(n.fields||[],n.data||[],te);throw new Error("Unable to serialize unrecognized input");function Y(w,p,W){var z="",J=(typeof w=="string"&&(w=JSON.parse(w)),typeof p=="string"&&(p=JSON.parse(p)),Array.isArray(w)&&0<w.length),ne=!Array.isArray(p[0]);if(J&&h){for(var C=0;C<w.length;C++)0<C&&(z+=f),z+=v(w[C],C);0<p.length&&(z+=y)}for(var S=0;S<p.length;S++){var $=(J?w:p[S]).length,b=!1,A=J?Object.keys(p[S]).length===0:p[S].length===0;if(W&&!J&&(b=W==="greedy"?p[S].join("").trim()==="":p[S].length===1&&p[S][0].length===0),W==="greedy"&&J){for(var K=[],B=0;B<$;B++){var I=ne?w[B]:B;K.push(p[S][I])}b=K.join("").trim()===""}if(!b){for(var k=0;k<$;k++){0<k&&!A&&(z+=f);var Z=J&&ne?w[k]:k;z+=v(p[S][Z],k)}S<p.length-1&&(!W||0<$&&!A)&&(z+=y)}}return z}function v(w,p){var W,z;return w==null?"":w.constructor===Date?JSON.stringify(w).slice(1,25):(z=!1,j&&typeof w=="string"&&j.test(w)&&(w="'"+w,z=!0),W=w.toString().replace(m,V),(z=z||a===!0||typeof a=="function"&&a(w,p)||Array.isArray(a)&&a[p]||((J,ne)=>{for(var C=0;C<ne.length;C++)if(-1<J.indexOf(ne[C]))return!0;return!1})(W,u.BAD_DELIMITERS)||-1<W.indexOf(f)||W.charAt(0)===" "||W.charAt(W.length-1)===" ")?M+W+M:W)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!l&&!!s.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=T,u.ParserHandle=P,u.NetworkStreamer=O,u.FileStreamer=U,u.StringStreamer=N,u.ReadableStreamStreamer=G,s.jQuery&&((o=s.jQuery).fn.parse=function(n){var t=n.config||{},a=[];return this.each(function(y){if(!(o(this).prop("tagName").toUpperCase()==="INPUT"&&o(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var M=0;M<this.files.length;M++)a.push({file:this.files[M],inputElem:this,instanceConfig:o.extend({},t)})}),h(),this;function h(){if(a.length===0)R(n.complete)&&n.complete();else{var y,M,V,te,E=a[0];if(R(n.before)){var j=n.before(E.file,E.inputElem);if(typeof j=="object"){if(j.action==="abort")return y="AbortError",M=E.file,V=E.inputElem,te=j.reason,void(R(n.error)&&n.error({name:y},M,V,te));if(j.action==="skip")return void f();typeof j.config=="object"&&(E.instanceConfig=o.extend(E.instanceConfig,j.config))}else if(j==="skip")return void f()}var m=E.instanceConfig.complete;E.instanceConfig.complete=function(Y){R(m)&&m(Y,E.file,E.inputElem),f()},u.parse(E.file,E.instanceConfig)}}function f(){a.splice(0,1),h()}}),d&&(s.onmessage=function(n){n=n.data,u.WORKER_ID===void 0&&n&&(u.WORKER_ID=n.workerId),typeof n.input=="string"?s.postMessage({workerId:u.WORKER_ID,results:u.parse(n.input,n.config),finished:!0}):(s.File&&n.input instanceof File||n.input instanceof Object)&&(n=u.parse(n.input,n.config))&&s.postMessage({workerId:u.WORKER_ID,results:n,finished:!0})}),(O.prototype=Object.create(g.prototype)).constructor=O,(U.prototype=Object.create(g.prototype)).constructor=U,(N.prototype=Object.create(N.prototype)).constructor=N,(G.prototype=Object.create(g.prototype)).constructor=G,u})})(be)),be.exports}var Qe=Ke();const Ge=Ne(Qe);function Je(e,r){return"csv/"+r+"_allmatch_result-J"+e+".csv"}async function Ve(e="./json/season_map.json"){const r=await fetch(e);if(!r.ok)throw new Error(`Failed to load season map: ${r.status} ${r.statusText}`);return r.json()}function Ee(e,r){const i="0000"+e;return i.substring(i.length-r)}function Ye(e){return typeof e=="string"?e:[e.getFullYear(),Ee(e.getMonth()+1,2),Ee(e.getDate(),2)].join("/")}function ke(e){return typeof e=="string"?e.replace(/(\d\d:\d\d):\d\d/,"$1"):[Ee(e.getHours(),2),Ee(e.getMinutes(),2)].join(":")}function we(e){return e.replace(/^\d{4}\//,"")}function Be(e,r,i=!1,s=null,o=null){return e&&r?e>r?3:e<r?0:s!==null&&o!==null&&s>o?2:1:0}function Ze(e){return e.status==="ＶＳ"?"開始前":e.status.replace("速報中","")}function Xe(e){return e.status.includes("速報中")}function De(e,r,i,s=null){const o={};s==="null"&&(s="DefaultGroup"),r.includes("group")&&(s=null);for(const l of e){const d=s??l.group??"DefaultGroup";if(!(d in o)){o[d]={};for(const L of i)o[d][L]={df:[]}}l.home_team in o[d]||(o[d][l.home_team]={df:[]}),l.away_team in o[d]||(o[d][l.away_team]={df:[]});let _=l.match_date;const c=new Date(l.match_date);isNaN(c.getTime())||(_=Ye(c));const u=l.home_pk_score?parseInt(l.home_pk_score):null,g=l.away_pk_score?parseInt(l.away_pk_score):null,O=!!(l.home_goal&&l.away_goal),U=Ze(l),N=Xe(l),G={is_home:!0,opponent:l.away_team,goal_get:l.home_goal,goal_lose:l.away_goal,pk_get:u,pk_lose:g,has_result:O,point:Be(l.home_goal,l.away_goal,!1,u,g),match_date:_,section_no:l.section_no,stadium:l.stadium,start_time:l.start_time,status:U,live:N};o[d][l.home_team].df.push(G);const P={is_home:!1,opponent:l.home_team,goal_get:l.away_goal,goal_lose:l.home_goal,pk_get:g,pk_lose:u,has_result:O,point:Be(l.away_goal,l.home_goal,!1,g,u),match_date:_,section_no:l.section_no,stadium:l.stadium,start_time:l.start_time,status:U,live:N};o[d][l.away_team].df.push(P)}return o}function ze(e){return{teamCount:e[0],promotionCount:e[1],relegationCount:e[2],teams:e[3],rankClass:e[4]??{},extra:e[5]??{}}}function ye(e,r){return(r??0)-(e??0)}function D(e,r,i){const s=(i?"disp_":"")+r;return e[s]??0}function Ie(e,r){return Object.keys(r).sort((i,s)=>{const o=r[i][e]??0;return(r[s][e]??0)-o})}function et(e,r){const i=r.startsWith("disp_");return Object.keys(e).sort((s,o)=>{const l=_=>e[_][r]??0;let d=ye(l(s),l(o));if(d!==0)return d;if(r.endsWith("avlbl_pt")){const _=r.replace("avlbl_pt","point"),c=u=>e[u][_]??0;if(d=ye(c(s),c(o)),d!==0)return d}return d=ye(D(e[s],"goal_diff",i),D(e[o],"goal_diff",i)),d!==0?d:ye(D(e[s],"goal_get",i),D(e[o],"goal_get",i))})}function tt(e){const r={};for(const i of Object.keys(e)){const s=e[i];r[i]={point:s.point??0,avlbl_pt:s.avlbl_pt??0,disp_point:s.disp_point??0,disp_avlbl_pt:s.disp_avlbl_pt??0,rest_games:s.rest_games??{},disp_rest_games:s.disp_rest_games??{}}}return r}function Se(e,r,i){const s=r?"disp_avlbl_pt":"avlbl_pt",o=Ie(s,i);return e>=o.length?0:(i[o[e]][s]??0)+1}function xe(e,r,i){const s=r?"disp_point":"point",o=Ie(s,i);return e<=0||e>o.length?0:i[o[e-1]][s]??0}function Re(e,r,i,s){const o=i?"disp_avlbl_pt":"avlbl_pt",l=i?"disp_rest_games":"rest_games",d=e-1,_=tt(s);delete _[r];const c=Ie(o,_),u=s[r][l]??{};for(const g of Object.keys(u))_[g]!==void 0&&(_[g][o]-=3*(u[g]??0));return d>=c.length?0:_[c[d]][o]}function Fe(e,r){if(e.has_result)return 0;const i=e.match_date;return i&&/\d\d\/\d\d$/.test(i)&&i<=r?1:2}function nt(e,r,i){e.df.sort((s,o)=>{const l=Fe(s,r),d=Fe(o,r);if(l!==d)return l-d;const _=s[i],c=o[i];return i==="section_no"?parseInt(_)-parseInt(c):/\d\d\/\d\d$/.test(_)?/\d\d\/\d\d$/.test(c)?_<c?-1:_>c?1:0:-1:/\d\d\/\d\d$/.test(c)?1:0})}function st(e,r,i){e.point=0,e.avlbl_pt=0,e.goal_diff=0,e.goal_get=0,e.win=0,e.pk_win=0,e.pk_loss=0,e.lose=0,e.draw=0,e.all_game=0,e.rest_games={},e.disp_avlbl_pt=0,e.disp_point=0,e.disp_goal_diff=0,e.disp_goal_get=0,e.disp_win=0,e.disp_pk_win=0,e.disp_pk_loss=0,e.disp_lose=0,e.disp_draw=0,e.disp_all_game=0,e.disp_rest_games={},nt(e,r,i);for(const s of e.df)s.has_result?(e.point+=s.point,e.avlbl_pt+=s.point,e.all_game+=1,s.point===3?e.win+=1:s.point===2?e.pk_win+=1:s.point===1&&s.pk_get!==null?e.pk_loss+=1:s.point===1?e.draw+=1:e.lose+=1,e.goal_diff+=parseInt(s.goal_get)-parseInt(s.goal_lose),e.goal_get+=parseInt(s.goal_get),s.match_date<=r?(s.point===3?e.disp_win+=1:s.point===2?e.disp_pk_win+=1:s.point===1&&s.pk_get!==null?e.disp_pk_loss+=1:s.point===1?e.disp_draw+=1:e.disp_lose+=1,e.disp_all_game+=1,e.disp_point+=s.point,e.disp_avlbl_pt+=s.point,e.disp_goal_diff+=parseInt(s.goal_get)-parseInt(s.goal_lose),e.disp_goal_get+=parseInt(s.goal_get)):(e.disp_avlbl_pt+=3,e.disp_rest_games[s.opponent]=(e.disp_rest_games[s.opponent]??0)+1)):(e.avlbl_pt+=3,e.disp_avlbl_pt+=3,e.rest_games[s.opponent]=(e.rest_games[s.opponent]??0)+1,e.disp_rest_games[s.opponent]=(e.disp_rest_games[s.opponent]??0)+1);e.avrg_pt=e.all_game===0?0:e.point/e.all_game,e.disp_avrg_pt=e.disp_all_game===0?0:e.disp_point/e.disp_all_game}function rt(e){return Object.values(e).reduce((r,i)=>r+Object.keys(i.rest_games??{}).length,0)}function it(e,r,i,s){const{teamCount:o,promotionCount:l,relegationCount:d}=i,_=o-d,c=xe(1,s,e),u=Se(1,s,e),g=d>0?xe(_,s,e):void 0,O=d>0?Se(_,s,e):void 0,U=Se(l,s,e),N=xe(l,s,e),G=rt(e)===0,P=[];let L=0;for(const T of r){L++;const H=e[T],ue=D(H,"point",s),re=D(H,"avlbl_pt",s),ce=D(H,"all_game",s),se=D(H,"goal_get",s),R=D(H,"goal_diff",s),n=D(H,"avrg_pt",s),t={rank:L,name:`<div class="${T}">${T}</div>`,win:D(H,"win",s),pk_win:D(H,"pk_win",s),pk_loss:D(H,"pk_loss",s),draw:D(H,"draw",s),lose:D(H,"lose",s),point:ue,avlbl_pt:re,avrg_pt:n.toFixed(2),all_game:ce,goal_get:se,goal_diff:R,goal_lose:se-R,future_game:H.df.length-ce,champion:""};if(G)t.champion=L<=1?"確定":"なし",l>0&&(t.promotion=L<=l?"確定":"なし"),d>0&&(t.relegation=L<=_?"確定":"降格");else{const a=re-c,h=ue-u,f=re-Re(1,T,s,e);if(t.champion=h>=0?"確定":a<0?"なし":f>=0?"自力":"他力",l>0){const y=re-N,M=ue-U,V=re-Re(l,T,s,e);t.promotion=M>=0?"確定":y<0?"なし":V>=0?"自力":"他力"}if(d>0&&O!==void 0&&g!==void 0){const y=ue-O,M=re-g,V=re-Re(_,T,s,e);t.relegation=y>=0?"確定":M<0?"降格":V>=0?"自力":"他力"}else t.relegation="確定"}P.push(t)}return P}function ot(e,r){const i=new SortableTable;i.setTable(e),i.setData(r)}function Me(e,r){return we(r)+" "+e.opponent+"<br/>"+e.goal_get+"-"+e.goal_lose+"<br/>"+e.stadium}function at(e,r){return we(r)+" "+e.opponent+"<br/>"+e.goal_get+"-"+e.goal_lose+" ("+e.pk_get+"-"+e.pk_lose+")<br/>"+e.stadium}function lt(e,r){return we(r)+" "+e.opponent}function Pe(e,r){return"("+e.section_no+") "+ke(e.start_time)+"<br/>"+we(r)+" "+e.opponent+"<br/>"+e.goal_get+"-"+e.goal_lose+" "+e.stadium}function ut(e,r){const i=r?"disp_":"",s=r?"表示時の状態":"最新の状態",o=l=>e[i+l]??0;return s+"<br/>"+o("win")+"勝 "+o("pk_win")+"PK勝 "+o("pk_loss")+"PK負 "+o("draw")+"分 "+o("lose")+"敗<br/>勝点"+o("point")+", 最大"+o("avlbl_pt")+"<br/>"+o("goal_get")+"得点, "+(o("goal_get")-o("goal_diff"))+"失点<br/>得失点差: "+o("goal_diff")}function ct(e){return e.join("<hr/>")}function dt(e,r){const i=r.rankClass[String(e)];return i||(e<=r.promotionCount?"promoted":e>r.teamCount-r.relegationCount?"relegated":"")}function ft(e,r){const i=e.startsWith("#")?e.slice(1):e,s=Math.floor(i.length/3);if(s<1)return 0;const o=[0,1,2].map(c=>parseInt(i.slice(s*c,s*(c+1)),16)),l=r.r,d=r.g,_=r.b;return Math.max(o[0]*l,o[1]*d,o[2]*_)/255}function ht(e,r,i,s){const o=[],l=[],d=new Set;for(const c of r.df){const u=c.match_date===""?"未定":c.match_date;if(u!=="未定"&&d.add(u),!c.has_result||u>i)o.push('<div class="tall box"><div class="future bg '+e+'"></div><p class="tooltip">'+Me(c,u)+'<span class="tooltiptext '+e+'">('+c.section_no+") "+ke(c.start_time)+(c.status?"<br/>"+c.status:"")+`</span></p></div>
`);else if(c.point===3)o.push('<div class="tall box'+(c.live?" live":"")+'"><p class="tooltip '+e+'">'+Me(c,u)+'<span class="tooltiptext halfW '+e+'">('+c.section_no+") "+ke(c.start_time)+(c.status?"<br/>"+c.status:"")+`</span></p></div>
`);else if(c.point===2)o.push('<div class="medium box'+(c.live?" live":"")+'"><p class="tooltip '+e+'">'+at(c,u)+'<span class="tooltiptext halfW '+e+'">('+c.section_no+") "+ke(c.start_time)+"<br/>"+c.stadium+(c.status?"<br/>"+c.status:"")+`</span></p></div>
`);else if(c.point===1)o.push('<div class="short box'+(c.live?" live":"")+'"><p class="tooltip '+e+'">'+lt(c,u)+'<span class="tooltiptext fullW '+e+'">'+Pe(c,u)+(c.status?"<br/>"+c.status:"")+"</span></p></div>");else{let g=Pe(c,u);c.live&&(g='<div class="live">'+g+(c.status?"<br/>"+c.status:"")+"</div>"),l.push(g)}}const _=s?r.disp_avlbl_pt??0:r.avlbl_pt??0;return{graph:o,avlbl_pt:_,teamName:e,loseBox:l,stats:ut(r,s),matchDates:[...d].sort()}}function pt(e){const r=[Math.floor(e.teamCount/2)];return e.promotionCount!==0&&r.unshift(e.promotionCount),e.relegationCount!==0&&r.push(e.teamCount-e.relegationCount),r}function _t(e,r){const i=Array.from({length:e},(s,o)=>o+1).map(s=>'<div class="point box">'+s+"</div>");return r&&i.reverse(),'<div class="point_column"><div class="point box">順位</div><div class="point box">勝点</div>'+i.join("")+`<div class="point box">勝点</div><div class="point box">順位</div></div>

`}function gt(e,r,i,s,o,l){const d=[...e.graph],_=[...e.loseBox],c=i-e.avlbl_pt;c>0&&d.push('<div class="space box" style="height:'+s*c+'px">('+c+")</div>"),o&&(d.reverse(),_.reverse());const g='<div class="short box '+dt(r,l)+'">'+r+"</div>",O='<div class="short box tooltip '+e.teamName+'">'+e.teamName+'<span class=" tooltiptext fullW '+e.teamName+'">成績情報:<hr/>'+e.stats+"<hr/>敗戦記録:<hr/>"+ct(_)+`</span></div>
`;return'<div id="'+e.teamName+'_column">'+g+O+d.join("")+O+g+`</div>

`}function mt(e,r,i,s,o,l,d,_){const c={},u=new Set;let g=0;for(const P of r){const L=e[P];if(!L)continue;const T=ht(P,L,s,o);c[P]=T,g=Math.max(g,T.avlbl_pt);for(const H of T.matchDates)u.add(H)}const O=[...u].sort(),U=_t(g,d),N=new Set(pt(i));let G=U;return r.forEach((P,L)=>{N.has(L)&&(G+=U);const T=c[P];T&&(G+=gt(T,L+1,g,_,d,i))}),G+=U,{html:G,matchDates:O}}const yt={r:.9,g:.8,b:.4};function Oe(e){let r;for(const i of Array.from(document.styleSheets))if(i.href&&i.href.endsWith("j_points.css")){r=i;break}if(r){for(const i of Array.from(r.cssRules))if(i.selectorText===e)return i}}function vt(){const e=Oe(".short");return e&&parseInt(e.style.height)||0}function bt(e,r=!0){const i=Oe(".future");if(!i)return;i.style.opacity=e;const s=document.getElementById("current_opacity");if(s&&(s.textContent=e),r){const o=document.getElementById("future_opacity");o&&(o.value=e)}}function kt(e,r=!0){const i=Oe(".space");if(i&&(i.style.backgroundColor=e,i.style.color=ft(e,yt)>.5?"black":"white",r)){const s=document.getElementById("space_color");s&&(s.value=e)}}function Ue(e,r,i=!0){e.style.transform="scale("+r+")";const s=e.querySelector(".point_column");if(s&&(e.style.height=String(s.clientHeight*parseFloat(r))+"px"),i){const o=document.getElementById("scale_slider");o&&(o.value=r);const l=document.getElementById("current_scale");l&&(l.textContent=r)}}function ve(e){return document.getElementById(e).value}function me(e){const r=document.getElementById("status_msg");r&&(r.textContent=e)}function Et(e){return["first_bottom","last_bottom"].includes(e)?"section_no":"match_date"}function wt(e){return["old_bottom","first_bottom"].includes(e)}function je(e,r){const i=document.getElementById("season_key");i.innerHTML="";const s=Object.keys(e[r]??{}).sort().reverse();for(const o of s){const l=document.createElement("option");l.value=o,l.textContent=o,i.appendChild(l)}}let We=[];function Ct(e,r){We=e;const i=document.getElementById("date_slider");if(!i||e.length===0)return;i.max=String(e.length-1);let s=e.length-1;for(let d=0;d<e.length;d++)if(e[d]>r){s=Math.max(0,d-1);break}i.value=String(s);const o=document.getElementById("post_date_slider");o&&(o.textContent=e[e.length-1]??"");const l=document.getElementById("target_date_display");l&&(l.textContent=r)}let pe=null,qe=20;function $e(e,r,i,s,o,l,d,_,c){const u=r[i]?.[s];if(!u)return;const g=ze(u),O={};for(const[L,T]of Object.entries(e.groupData))O[L]={...T,df:[...T.df]};for(const L of Object.values(O))st(L,o,d);const U=et(O,l),N=document.getElementById("box_container");if(N){const{html:L,matchDates:T}=mt(O,U,g,o,c,d,_,qe);N.innerHTML=L;const H=document.getElementById("scale_slider");Ue(N,H?.value??"1",!1),Ct(T,o)}const G=it(O,U,g,c),P=document.getElementById("ranktable");P&&ot(P,G)}function he(e){const r=ve("category_key"),i=ve("season_key"),s=`${r}/${i}`,l=document.getElementById("target_date").value.replace(/-/g,"/"),d=ve("match_sort_key"),_=ve("team_sort_key"),c=Et(d),u=wt(d),g=_.startsWith("disp_"),O=e[r]?.[i];if(!O){me(`シーズン情報なし: ${r}/${i}`);return}const U=ze(O);if(pe?.key===s){$e(pe,e,r,i,l,_,c,u,g),me(`${r} ${i} (cached)`);return}const N=Je(r,i),G=Math.floor(Date.now()/1e3/300);me("CSVを読み込み中..."),Ge.parse(N+"?_="+G,{header:!0,skipEmptyLines:"greedy",download:!0,complete:P=>{const T=De(P.data,P.meta.fields??[],U.teams,"matches").matches??{};pe={key:s,groupData:T,teamCount:U.teamCount},$e(pe,e,r,i,l,_,c,u,g),me(`${r} ${i} — ${P.data.length} 行`)},error:P=>{me(`CSV読み込みエラー: ${String(P)}`)}})}async function St(){const e=await Ve(),r=vt();r>0&&(qe=r);const i=new Date,s=i.getFullYear(),o=String(i.getMonth()+1).padStart(2,"0"),l=String(i.getDate()).padStart(2,"0");document.getElementById("target_date").value=`${s}-${o}-${l}`;const d=document.getElementById("category_key");je(e,d.value),d.addEventListener("change",()=>{pe=null,je(e,d.value),he(e)}),document.getElementById("season_key")?.addEventListener("change",()=>{pe=null,he(e)});for(const u of["target_date","team_sort_key","match_sort_key"])document.getElementById(u)?.addEventListener("change",()=>he(e));const _=document.getElementById("date_slider");if(_){const u=()=>{const g=We[parseInt(_.value)];if(g){document.getElementById("target_date").value=g.replace(/\//g,"-");const O=document.getElementById("target_date_display");O&&(O.textContent=g),he(e)}};_.addEventListener("change",u),document.getElementById("date_slider_down")?.addEventListener("click",()=>{_.value=String(Math.max(0,parseInt(_.value)-1)),u()}),document.getElementById("date_slider_up")?.addEventListener("click",()=>{_.value=String(Math.min(parseInt(_.max),parseInt(_.value)+1)),u()}),document.getElementById("reset_date_slider")?.addEventListener("click",()=>{const g=new Date;document.getElementById("target_date").value=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}-${String(g.getDate()).padStart(2,"0")}`,he(e)})}const c=document.getElementById("box_container");document.getElementById("scale_slider")?.addEventListener("input",u=>{Ue(c,u.target.value)}),document.getElementById("future_opacity")?.addEventListener("input",u=>{bt(u.target.value)}),document.getElementById("space_color")?.addEventListener("input",u=>{kt(u.target.value)}),he(e)}St().catch(console.error);
