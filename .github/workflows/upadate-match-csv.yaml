name: Update matches csv

on:
  schedule:
    - cron: '0 16 * * *'
    - cron: '15 6 11 3 *'
    - cron: '15 7 11 3 *'
    - cron: '15 8 11 3 *'
    - cron: '15 10 11 3 *'
    - cron: '15 6 12 3 *'
    - cron: '15 7 12 3 *'
    - cron: '15 8 12 3 *'
    - cron: '15 9 12 3 *'
    - cron: '15 10 12 3 *'
    - cron: '15 7 18 3 *'
    - cron: '15 8 18 3 *'
    - cron: '15 9 18 3 *'
    - cron: '15 6 19 3 *'
    - cron: '15 7 19 3 *'
    - cron: '15 7 25 3 *'
    - cron: '15 8 25 3 *'
    - cron: '15 6 26 3 *'
    - cron: '15 7 26 3 *'
    - cron: '15 8 26 3 *'
    - cron: '15 10 26 3 *'
    - cron: '15 12 29 3 *'
    - cron: '15 12 31 3 *'
    - cron: '15 6 1 4 *'
    - cron: '15 7 1 4 *'
    - cron: '15 8 1 4 *'
    - cron: '15 9 1 4 *'
    - cron: '15 12 1 4 *'
    - cron: '15 6 2 4 *'
    - cron: '15 7 2 4 *'
    - cron: '15 8 2 4 *'
    - cron: '15 6 8 4 *'
    - cron: '15 7 8 4 *'
    - cron: '15 8 8 4 *'
    - cron: '15 10 8 4 *'
    - cron: '15 12 8 4 *'
    - cron: '15 6 9 4 *'
    - cron: '15 7 9 4 *'
    - cron: '15 8 9 4 *'
    - cron: '15 12 9 4 *'
    - cron: '15 12 12 4 *'
    - cron: '15 6 15 4 *'
    - cron: '15 7 15 4 *'
    - cron: '15 8 15 4 *'
    - cron: '15 9 15 4 *'
    - cron: '15 10 15 4 *'
    - cron: '15 6 16 4 *'
    - cron: '15 7 16 4 *'
    - cron: '15 8 16 4 *'
    - cron: '15 9 16 4 *'
    - cron: '15 12 21 4 *'
    - cron: '15 7 22 4 *'
    - cron: '15 8 22 4 *'
    - cron: '15 12 22 4 *'
    - cron: '15 7 23 4 *'
    - cron: '15 8 23 4 *'
    - cron: '15 9 23 4 *'
    - cron: '15 6 29 4 *'
    - cron: '15 7 29 4 *'
    - cron: '15 8 29 4 *'
    - cron: '15 10 29 4 *'
    - cron: '15 12 29 4 *'
    - cron: '15 6 30 4 *'
    - cron: '15 7 30 4 *'
    - cron: '15 8 30 4 *'
    - cron: '15 6 3 5 *'
    - cron: '5 7 3 5 *'
    - cron: '10 7 3 5 *'
    - cron: '15 7 3 5 *'
    - cron: '15 8 3 5 *'
    - cron: '15 9 3 5 *'
    - cron: '15 10 3 5 *'
    - cron: '45 11 3 5 *'
    - cron: '15 12 3 5 *'
    - cron: '15 7 4 5 *'
    - cron: '15 7 6 5 *'
    - cron: '15 12 6 5 *'
    - cron: '15 6 7 5 *'
    - cron: '15 7 7 5 *'
    - cron: '15 8 7 5 *'
    - cron: '15 12 7 5 *'
    - cron: '45 12 10 5 *'
    - cron: '45 12 12 5 *'
    - cron: '15 6 13 5 *'
    - cron: '30 6 13 5 *'
    - cron: '15 7 13 5 *'
    - cron: '15 8 13 5 *'
    - cron: '15 9 13 5 *'
    - cron: '15 10 13 5 *'
    - cron: '15 11 13 5 *'
    - cron: '15 6 14 5 *'
    - cron: '45 6 14 5 *'
    - cron: '15 7 14 5 *'
    - cron: '15 9 14 5 *'
    - cron: '45 6 17 5 *'
    - cron: '15 12 17 5 *'
    - cron: '45 12 19 5 *'
    - cron: '15 6 20 5 *'
    - cron: '15 8 20 5 *'
    - cron: '15 9 20 5 *'
    - cron: '15 10 20 5 *'
    - cron: '15 12 20 5 *'
    - cron: '15 7 21 5 *'
    - cron: '15 8 21 5 *'
    - cron: '15 9 21 5 *'
    - cron: '15 12 21 5 *'
    - cron: '15 6 27 5 *'
    - cron: '15 7 27 5 *'
    - cron: '15 8 27 5 *'
    - cron: '15 10 27 5 *'
    - cron: '15 12 27 5 *'
    - cron: '15 5 28 5 *'
    - cron: '15 6 28 5 *'
    - cron: '15 7 28 5 *'
    - cron: '15 8 28 5 *'
    - cron: '15 10 28 5 *'
    - cron: '15 12 28 5 *'
    - cron: '45 12 31 5 *'
    - cron: '15 6 3 6 *'
    - cron: '15 7 3 6 *'
    - cron: '15 8 3 6 *'
    - cron: '15 9 3 6 *'
    - cron: '15 11 3 6 *'
    - cron: '45 11 3 6 *'
    - cron: '15 12 3 6 *'
    - cron: '15 6 4 6 *'
    - cron: '15 7 4 6 *'
    - cron: '15 10 4 6 *'
    - cron: '15 9 10 6 *'
    - cron: '15 10 10 6 *'
    - cron: '15 12 10 6 *'
    - cron: '20 6 11 6 *'
    - cron: '15 7 11 6 *'
    - cron: '15 8 11 6 *'
    - cron: '15 9 11 6 *'
    - cron: '15 11 11 6 *'
    - cron: '45 11 11 6 *'
    - cron: '15 12 11 6 *'
    - cron: '15 7 17 6 *'
    - cron: '15 10 17 6 *'
    - cron: '15 11 17 6 *'
    - cron: '15 12 17 6 *'
    - cron: '15 7 18 6 *'
    - cron: '15 9 18 6 *'
    - cron: '15 10 18 6 *'
    - cron: '15 11 18 6 *'
    - cron: '15 12 18 6 *'
    - cron: '15 7 24 6 *'
    - cron: '15 8 24 6 *'
    - cron: '15 10 24 6 *'
    - cron: '15 11 24 6 *'
    - cron: '45 11 24 6 *'
    - cron: '15 12 24 6 *'
    - cron: '45 12 24 6 *'
    - cron: '15 11 25 6 *'
    - cron: '15 12 25 6 *'
    - cron: '45 12 25 6 *'
    - cron: '15 12 28 6 *'
    - cron: '45 12 28 6 *'
    - cron: '15 12 30 6 *'
    - cron: '15 10 1 7 *'
    - cron: '15 11 1 7 *'
    - cron: '45 11 1 7 *'
    - cron: '15 12 1 7 *'
    - cron: '45 12 1 7 *'
    - cron: '15 9 2 7 *'
    - cron: '15 11 2 7 *'
    - cron: '15 12 2 7 *'
    - cron: '15 12 5 7 *'
    - cron: '15 12 7 7 *'
    - cron: '15 10 8 7 *'
    - cron: '15 11 8 7 *'
    - cron: '45 11 8 7 *'
    - cron: '15 12 8 7 *'
    - cron: '45 12 8 7 *'
    - cron: '15 8 9 7 *'
    - cron: '15 11 9 7 *'
    - cron: '15 12 9 7 *'
    - cron: '15 6 15 7 *'
    - cron: '15 11 15 7 *'
    - cron: '15 12 15 7 *'
    - cron: '15 11 16 7 *'
    - cron: '15 12 16 7 *'
    - cron: '15 8 22 7 *'
    - cron: '15 11 22 7 *'
    - cron: '45 11 22 7 *'
    - cron: '15 12 22 7 *'
    - cron: '15 11 23 7 *'
    - cron: '15 12 23 7 *'
    - cron: '15 12 24 7 *'
    - cron: '15 11 29 7 *'
    - cron: '15 12 29 7 *'
    - cron: '15 10 30 7 *'
    - cron: '15 12 30 7 *'
    - cron: '15 10 5 8 *'
    - cron: '15 11 5 8 *'
    - cron: '15 12 5 8 *'
    - cron: '15 8 6 8 *'
    - cron: '15 11 6 8 *'
    - cron: '45 11 6 8 *'
    - cron: '15 12 6 8 *'
    - cron: '15 7 12 8 *'
    - cron: '15 10 12 8 *'
    - cron: '15 11 12 8 *'
    - cron: '45 11 12 8 *'
    - cron: '15 12 12 8 *'
    - cron: '45 12 12 8 *'
    - cron: '15 8 13 8 *'
    - cron: '15 11 13 8 *'
    - cron: '15 12 13 8 *'
    - cron: '15 12 18 8 *'
    - cron: '15 11 19 8 *'
    - cron: '15 12 19 8 *'
    - cron: '45 12 19 8 *'
    - cron: '15 11 20 8 *'
    - cron: '45 11 20 8 *'
    - cron: '15 12 20 8 *'
    - cron: '15 12 25 8 *'
    - cron: '15 8 26 8 *'
    - cron: '15 11 26 8 *'
    - cron: '45 11 26 8 *'
    - cron: '15 12 26 8 *'
    - cron: '15 10 27 8 *'
    - cron: '15 11 27 8 *'
    - cron: '15 12 27 8 *'

jobs:
  build:

    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        python-version: [3.9]

    steps:
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v2
      with:
        python-version: ${{ matrix.python-version }}
    - name: Set git config
      run: |
        git config --global user.name "mokekuma-git"
        git config --global user.email "mokekuma.git@gmail.com"
    - name: git checkout
      uses: actions/checkout@v2
      with:
        ref: main
    - name: Install Python dependencies
      uses: py-actions/py-dependency-install@v2
      with:
        path: "requirements.txt"
    - name: Update matches csv
      run: |
        DATE=`TZ=Asia/Tokyo date +'%m/%d %H:%M'`
        bash scripts/call_update_csv.sh github.event.schedule
        if (git diff --shortstat | grep '[0-9]'); then \
          git add .; \
          git commit -m "Make new csv (append games on $DATE)"; \
          git push origin HEAD; \
        fi
